<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>Anki的数据库结构说明 | 叶落花开的博客</title><meta name="keywords" content="数据库,Anki"><meta name="author" content="叶落花开"><meta name="copyright" content="叶落花开"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="This document contains a brief description of the Anki2 database structure as of version 11 (see ver field of the col table). There are planned upgrades to Anki’s db structure as explained in the plan">
<meta property="og:type" content="article">
<meta property="og:title" content="Anki的数据库结构说明">
<meta property="og:url" content="https://www.yeluohuakai.com/posts/2024/09/135ce13c.html">
<meta property="og:site_name" content="叶落花开的博客">
<meta property="og:description" content="This document contains a brief description of the Anki2 database structure as of version 11 (see ver field of the col table). There are planned upgrades to Anki’s db structure as explained in the plan">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2024-09-13T00:09:00.000Z">
<meta property="article:modified_time" content="2024-09-13T00:11:07.311Z">
<meta property="article:author" content="叶落花开">
<meta property="article:tag" content="数据库">
<meta property="article:tag" content="Anki">
<meta name="twitter:card" content="summary"><link rel="shortcut icon" href="/favicon.png"><link rel="canonical" href="https://www.yeluohuakai.com/posts/2024/09/135ce13c"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//www.google-analytics.com" crossorigin=""/><link rel="preconnect" href="//hm.baidu.com"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?2f8a615b51582cf280e790200f3527e6";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-LB2ZMBR4ZN"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-LB2ZMBR4ZN');
</script><script>(function(){
var el = document.createElement("script");
el.src = "https://lf1-cdn-tos.bytegoofy.com/goofy/ttzz/push.js?18da2b25537eeea1b5c8819ad9a03fc2279abb7e5ff9fdb01a2409cbd77b8f1db3e414cba65c376eba389ba56d9ee0846cad2206506a6529fe6ee21a7373effb434c445cf6444b10ea9756ea44e128a6";
el.id = "ttzz";
var s = document.getElementsByTagName("script")[0];
s.parentNode.insertBefore(el, s);
})(window)
</script><script async="async" crossorigin="anonymous" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6673854567363222"></script><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":false,"highlightLang":false,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://fastly.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js',
      css: 'https://fastly.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Anki的数据库结构说明',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-09-13 08:11:07'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="/css/index_code.css"><meta name="generator" content="Hexo 6.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/loading.gif" data-original="/img/ava.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data is-center"><div class="data-item"><a href="/archives/"><div class="headline">文章</div><div class="length-num">266</div></a></div><div class="data-item"><a href="/tags/"><div class="headline">标签</div><div class="length-num">106</div></a></div><div class="data-item"><a href="/categories/"><div class="headline">分类</div><div class="length-num">38</div></a></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://support.qq.com/product/377343"><i class="fa-fw fa fa-paper-plane"></i><span> 反馈</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="not-top-img" id="page-header"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">叶落花开的博客</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://support.qq.com/product/377343"><i class="fa-fw fa fa-paper-plane"></i><span> 反馈</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav></header><main class="layout" id="content-inner"><div id="post"><div id="post-info"><h1 class="post-title">Anki的数据库结构说明</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2024-09-13T00:09:00.000Z" title="发表于 2024-09-13 08:09:00">2024-09-13</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-09-13T00:11:07.311Z" title="更新于 2024-09-13 08:11:07">2024-09-13</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/IT%E6%8A%80%E6%9C%AF/">IT技术</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/IT%E6%8A%80%E6%9C%AF/Anki/">Anki</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span id="" data-flag-title="Anki的数据库结构说明"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="twikoo_visitors"></span></span></div></div></div><article class="post-content" id="article-container"><p>This document contains a brief description of the Anki2 database structure as of version 11 (see <code>ver</code> field of the <code>col</code> table). There are planned upgrades to Anki’s db structure as explained in <a target="_blank" rel="noopener" href="https://github.com/ankidroid/Anki-Android/wiki/Database-Structure-Planned-Changes.md">the planned changes document.</a></p>
<p>Thanks to @sartak and @fasiha for <a target="_blank" rel="noopener" href="https://gist.github.com/sartak/3921255">starting to make this</a>. Additional thanks to @bibstha for <a target="_blank" rel="noopener" href="https://github.com/bibstha/Anki-Android/wiki/Anki2-database-documentation">more documentation</a></p>
<h1 id="Anki-database-structure"><a href="#Anki-database-structure" class="headerlink" title="Anki database structure"></a>Anki database structure</h1><p><a target="_blank" rel="noopener" href="https://github.com/ankidroid/Anki-Android/wiki/Database-Structure#anki-database-structure"></a></p>
<p>Anki uses a single <a target="_blank" rel="noopener" href="https://sqlite.org/index.html">SQLite</a> database to store information on all of its decks, templates, fields and cards. This file can be found inside the Anki package file (the <code>.apkg</code> file) with the extension <code>.anki2</code>.</p>
<p>Extracting <code>example.apkg</code> we have the following structure.</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">.</span><br><span class="line">├── example</span><br><span class="line">│&amp;nbsp;&amp;nbsp; ├── example.anki2</span><br><span class="line">│&amp;nbsp;&amp;nbsp; └── media</span><br><span class="line">└── example.apkg</span><br></pre></td></tr></table></figure>
<span id="more"></span>
<p>In linux <code>sqliteman</code> or <code>sqlite3</code> can be used to read and modify the <code>.anki2</code> files.</p>
<h1 id="Terminology"><a href="#Terminology" class="headerlink" title="Terminology"></a>Terminology</h1><p><a target="_blank" rel="noopener" href="https://github.com/ankidroid/Anki-Android/wiki/Database-Structure#terminology"></a></p>
<p>Anki contains basically the following types:</p>
<ol>
<li> Cards</li>
<li> Decks</li>
<li> Notes</li>
<li> Templates</li>
<li> Collection</li>
</ol>
<p>More information on what these represent are clearly explained in <a target="_blank" rel="noopener" href="http://ankisrs.net/docs/manual.html#basics">http://ankisrs.net/docs/manual.html#basics</a>.</p>
<p>This document often refers to “epoch seconds/milliseconds”. This is the amount of time that has passed since the <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Epoch_(computing)">Unix Epoch</a> (1 January 1970 00:00:00 UT).</p>
<h1 id="Database-schema"><a href="#Database-schema" class="headerlink" title="Database schema"></a>Database schema</h1><p><a target="_blank" rel="noopener" href="https://github.com/ankidroid/Anki-Android/wiki/Database-Structure#database-schema"></a></p>
<h2 id="Cards"><a href="#Cards" class="headerlink" title="Cards"></a>Cards</h2><p><a target="_blank" rel="noopener" href="https://github.com/ankidroid/Anki-Android/wiki/Database-Structure#cards"></a></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- Cards are what you review. </span></span><br><span class="line"><span class="comment">-- There can be multiple cards for each note, as determined by the Template.</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> cards (</span><br><span class="line">    id              <span class="type">integer</span> <span class="keyword">primary</span> key,</span><br><span class="line">      <span class="comment">-- the epoch milliseconds of when the card was created</span></span><br><span class="line">    nid             <span class="type">integer</span> <span class="keyword">not</span> <span class="keyword">null</span>,<span class="comment">--    </span></span><br><span class="line">      <span class="comment">-- notes.id</span></span><br><span class="line">    did             <span class="type">integer</span> <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">      <span class="comment">-- deck id (available in col table)</span></span><br><span class="line">    ord             <span class="type">integer</span> <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">      <span class="comment">-- ordinal : identifies which of the card templates or cloze deletions it corresponds to </span></span><br><span class="line">      <span class="comment">--   for card templates, valid values are from 0 to num templates - 1</span></span><br><span class="line">      <span class="comment">--   for cloze deletions, valid values are from 0 to max cloze index - 1 (they&#x27;re 0 indexed despite the first being called `c1`)</span></span><br><span class="line">    mod             <span class="type">integer</span> <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">      <span class="comment">-- modification time as epoch seconds</span></span><br><span class="line">    usn             <span class="type">integer</span> <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">      <span class="comment">-- update sequence number : used to figure out diffs when syncing. </span></span><br><span class="line">      <span class="comment">--   value of -1 indicates changes that need to be pushed to server. </span></span><br><span class="line">      <span class="comment">--   usn &lt; server usn indicates changes that need to be pulled from server.</span></span><br><span class="line">    type            <span class="type">integer</span> <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">      <span class="comment">-- 0=new, 1=learning, 2=review, 3=relearning</span></span><br><span class="line">    queue           <span class="type">integer</span> <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">      <span class="comment">-- -3=user buried(In scheduler 2),</span></span><br><span class="line">      <span class="comment">-- -2=sched buried (In scheduler 2), </span></span><br><span class="line">      <span class="comment">-- -2=buried(In scheduler 1),</span></span><br><span class="line">      <span class="comment">-- -1=suspended,</span></span><br><span class="line">      <span class="comment">-- 0=new, 1=learning, 2=review (as for type)</span></span><br><span class="line">      <span class="comment">-- 3=in learning, next rev in at least a day after the previous review</span></span><br><span class="line">      <span class="comment">-- 4=preview</span></span><br><span class="line">    due             <span class="type">integer</span> <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">     <span class="comment">-- Due is used differently for different card types: </span></span><br><span class="line">     <span class="comment">--   new: the order in which cards are to be studied; starts from 1.</span></span><br><span class="line">     <span class="comment">--   learning/relearning: epoch timestamp in seconds</span></span><br><span class="line">     <span class="comment">--   review: days since the collection&#x27;s creation time</span></span><br><span class="line">    ivl             <span class="type">integer</span> <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">      <span class="comment">-- interval (used in SRS algorithm). Negative = seconds, positive = days</span></span><br><span class="line">      <span class="comment">-- v2 scheduler used seconds for (re)learning cards and days for review cards</span></span><br><span class="line">      <span class="comment">-- v3 scheduler uses seconds only for intraday (re)learning cards and days for interday (re)learning cards and review cards</span></span><br><span class="line">    factor          <span class="type">integer</span> <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">      <span class="comment">-- The ease factor of the card in permille (parts per thousand). If the ease factor is 2500, the card’s interval will be multiplied by 2.5 the next time you press Good.</span></span><br><span class="line">    reps            <span class="type">integer</span> <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">      <span class="comment">-- number of reviews</span></span><br><span class="line">    lapses          <span class="type">integer</span> <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">      <span class="comment">-- the number of times the card went from a &quot;was answered correctly&quot; </span></span><br><span class="line">      <span class="comment">--   to &quot;was answered incorrectly&quot; state</span></span><br><span class="line">    <span class="keyword">left</span>            <span class="type">integer</span> <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">      <span class="comment">-- of the form a*1000+b, with:</span></span><br><span class="line">      <span class="comment">-- a the number of reps left today</span></span><br><span class="line">      <span class="comment">-- b the number of reps left till graduation</span></span><br><span class="line">      <span class="comment">-- for example: &#x27;2004&#x27; means 2 reps left today and 4 reps till graduation</span></span><br><span class="line">    odue            <span class="type">integer</span> <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">      <span class="comment">-- original due: In filtered decks, it&#x27;s the original due date that the card had before moving to filtered.</span></span><br><span class="line">                    <span class="comment">-- If the card lapsed in scheduler1, then it&#x27;s the value before the lapse. (This is used when switching to scheduler 2. At this time, cards in learning becomes due again, with their previous due date)</span></span><br><span class="line">                    <span class="comment">-- In any other case it&#x27;s 0.</span></span><br><span class="line">    odid            <span class="type">integer</span> <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">      <span class="comment">-- original did: only used when the card is currently in filtered deck</span></span><br><span class="line">    flags           <span class="type">integer</span> <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">      <span class="comment">-- an integer. This integer mod 8 represents a &quot;flag&quot;, which can be see in browser and while reviewing a note. Red 1, Orange 2, Green 3, Blue 4, no flag: 0. This integer divided by 8 represents currently nothing</span></span><br><span class="line">    data            text <span class="keyword">not</span> <span class="keyword">null</span></span><br><span class="line">      <span class="comment">-- currently unused</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<h2 id="Collection"><a href="#Collection" class="headerlink" title="Collection"></a>Collection</h2><p><a target="_blank" rel="noopener" href="https://github.com/ankidroid/Anki-Android/wiki/Database-Structure#collection"></a></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- col contains a single row that holds various information about the collection</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> col (</span><br><span class="line">    id              <span class="type">integer</span> <span class="keyword">primary</span> key,</span><br><span class="line">      <span class="comment">-- arbitrary number since there is only one row</span></span><br><span class="line">    crt             <span class="type">integer</span> <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">      <span class="comment">-- timestamp of the creation date in second. It&#x27;s correct up to the day. For V1 scheduler, the hour corresponds to starting a new day. By default, new day is 4.</span></span><br><span class="line">    mod             <span class="type">integer</span> <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">      <span class="comment">-- last modified in milliseconds</span></span><br><span class="line">    scm             <span class="type">integer</span> <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">      <span class="comment">-- schema mod time: time when &quot;schema&quot; was modified. </span></span><br><span class="line">      <span class="comment">--   If server scm is different from the client scm a full-sync is required</span></span><br><span class="line">    ver             <span class="type">integer</span> <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">      <span class="comment">-- version</span></span><br><span class="line">    dty             <span class="type">integer</span> <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">      <span class="comment">-- dirty: unused, set to 0</span></span><br><span class="line">    usn             <span class="type">integer</span> <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">      <span class="comment">-- update sequence number: used for finding diffs when syncing. </span></span><br><span class="line">      <span class="comment">--   See usn in cards table for more details.</span></span><br><span class="line">    ls              <span class="type">integer</span> <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">      <span class="comment">-- &quot;last sync time&quot;</span></span><br><span class="line">    conf            text <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">      <span class="comment">-- json object containing configuration options that are synced. Described below in &quot;configuration JSONObjects&quot;</span></span><br><span class="line">    models          text <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">      <span class="comment">-- json object of json object(s) representing the models (aka Note types) </span></span><br><span class="line">      <span class="comment">-- keys of this object are strings containing integers: &quot;creation time in epoch milliseconds&quot; of the models</span></span><br><span class="line">      <span class="comment">-- values of this object are other json objects of the form described below in &quot;Models JSONObjects&quot;</span></span><br><span class="line">    decks           text <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">      <span class="comment">-- json object of json object(s) representing the deck(s)</span></span><br><span class="line">      <span class="comment">-- keys of this object are strings containing integers: &quot;deck creation time in epoch milliseconds&quot; for most decks, &quot;1&quot; for the default deck</span></span><br><span class="line">      <span class="comment">-- values of this object are other json objects of the form described below in &quot;Decks JSONObjects&quot;</span></span><br><span class="line">    dconf           text <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">      <span class="comment">-- json object of json object(s) representing the options group(s) for decks</span></span><br><span class="line">      <span class="comment">-- keys of this object are strings containing integers: &quot;options group creation time in epoch milliseconds&quot; for most groups, &quot;1&quot; for the default option group</span></span><br><span class="line">      <span class="comment">-- values of this object are other json objects of the form described below in &quot;DConf JSONObjects&quot;</span></span><br><span class="line">    tags            text <span class="keyword">not</span> <span class="keyword">null</span></span><br><span class="line">      <span class="comment">-- a cache of tags used in the collection (This list is displayed in the browser. Potentially at other place)</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<h2 id="Graves"><a href="#Graves" class="headerlink" title="Graves"></a>Graves</h2><p><a target="_blank" rel="noopener" href="https://github.com/ankidroid/Anki-Android/wiki/Database-Structure#graves"></a></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- Contains deleted cards, notes, and decks that need to be synced. </span></span><br><span class="line"><span class="comment">-- usn should be set to -1, </span></span><br><span class="line"><span class="comment">-- oid is the original id.</span></span><br><span class="line"><span class="comment">-- type: 0 for a card, 1 for a note and 2 for a deck</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> graves (</span><br><span class="line">    usn             <span class="type">integer</span> <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">    oid             <span class="type">integer</span> <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">    type            <span class="type">integer</span> <span class="keyword">not</span> <span class="keyword">null</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<h2 id="Notes"><a href="#Notes" class="headerlink" title="Notes"></a>Notes</h2><p><a target="_blank" rel="noopener" href="https://github.com/ankidroid/Anki-Android/wiki/Database-Structure#notes"></a></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- Notes contain the raw information that is formatted into a number of cards</span></span><br><span class="line"><span class="comment">-- according to the models</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> notes (</span><br><span class="line">    id              <span class="type">integer</span> <span class="keyword">primary</span> key,</span><br><span class="line">      <span class="comment">-- epoch milliseconds of when the note was created</span></span><br><span class="line">    guid            text <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">      <span class="comment">-- globally unique id, almost certainly used for syncing</span></span><br><span class="line">    mid             <span class="type">integer</span> <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">      <span class="comment">-- model id</span></span><br><span class="line">    mod             <span class="type">integer</span> <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">      <span class="comment">-- modification timestamp, epoch seconds</span></span><br><span class="line">    usn             <span class="type">integer</span> <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">      <span class="comment">-- update sequence number: for finding diffs when syncing.</span></span><br><span class="line">      <span class="comment">--   See the description in the cards table for more info</span></span><br><span class="line">    tags            text <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">      <span class="comment">-- space-separated string of tags. </span></span><br><span class="line">      <span class="comment">--   includes space at the beginning and end, for LIKE &quot;% tag %&quot; queries</span></span><br><span class="line">    flds            text <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">      <span class="comment">-- the values of the fields in this note. separated by 0x1f (31) character.</span></span><br><span class="line">    sfld            <span class="type">integer</span> <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">      <span class="comment">-- sort field: used for quick sorting and duplicate check. The sort field is an integer so that when users are sorting on a field that contains only numbers, they are sorted in numeric instead of lexical order. Text is stored in this integer field.</span></span><br><span class="line">    csum            <span class="type">integer</span> <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">      <span class="comment">-- field checksum used for duplicate check.</span></span><br><span class="line">      <span class="comment">--   integer representation of first 8 digits of sha1 hash of the first field</span></span><br><span class="line">    flags           <span class="type">integer</span> <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">      <span class="comment">-- unused</span></span><br><span class="line">    data            text <span class="keyword">not</span> <span class="keyword">null</span></span><br><span class="line">      <span class="comment">-- unused</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<h2 id="Review-Log"><a href="#Review-Log" class="headerlink" title="Review Log"></a>Review Log</h2><p><a target="_blank" rel="noopener" href="https://github.com/ankidroid/Anki-Android/wiki/Database-Structure#review-log"></a></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- revlog is a review history; it has a row for every review you&#x27;ve ever done!</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> revlog (</span><br><span class="line">    id              <span class="type">integer</span> <span class="keyword">primary</span> key,</span><br><span class="line">       <span class="comment">-- epoch-milliseconds timestamp of when you did the review</span></span><br><span class="line">    cid             <span class="type">integer</span> <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">       <span class="comment">-- cards.id</span></span><br><span class="line">    usn             <span class="type">integer</span> <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">        <span class="comment">-- update sequence number: for finding diffs when syncing. </span></span><br><span class="line">        <span class="comment">--   See the description in the cards table for more info</span></span><br><span class="line">    ease            <span class="type">integer</span> <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">       <span class="comment">-- which button you pushed to score your recall. </span></span><br><span class="line">       <span class="comment">-- review:  1(wrong), 2(hard), 3(ok), 4(easy)</span></span><br><span class="line">       <span class="comment">-- learn/relearn:   1(wrong), 2(ok), 3(easy)</span></span><br><span class="line">    ivl             <span class="type">integer</span> <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">       <span class="comment">-- interval (i.e. as in the card table)</span></span><br><span class="line">    lastIvl         <span class="type">integer</span> <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">       <span class="comment">-- last interval (i.e. the last value of ivl. Note that this value is not necessarily equal to the actual interval between this review and the preceding review)</span></span><br><span class="line">    factor          <span class="type">integer</span> <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">      <span class="comment">-- factor</span></span><br><span class="line">    <span class="type">time</span>            <span class="type">integer</span> <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">       <span class="comment">-- how many milliseconds your review took, up to 60000 (60s)</span></span><br><span class="line">    type            <span class="type">integer</span> <span class="keyword">not</span> <span class="keyword">null</span></span><br><span class="line">       <span class="comment">--  0=learn, 1=review, 2=relearn, 3=filtered, 4=manual</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<h2 id="Indexes"><a href="#Indexes" class="headerlink" title="Indexes"></a>Indexes</h2><p><a target="_blank" rel="noopener" href="https://github.com/ankidroid/Anki-Android/wiki/Database-Structure#indexes"></a></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> INDEX ix_cards_nid <span class="keyword">on</span> cards (nid);</span><br><span class="line"><span class="keyword">CREATE</span> INDEX ix_cards_sched <span class="keyword">on</span> cards (did, queue, due);</span><br><span class="line"><span class="keyword">CREATE</span> INDEX ix_cards_usn <span class="keyword">on</span> cards (usn);</span><br><span class="line"><span class="keyword">CREATE</span> INDEX ix_notes_csum <span class="keyword">on</span> notes (csum);</span><br><span class="line"><span class="keyword">CREATE</span> INDEX ix_notes_usn <span class="keyword">on</span> notes (usn);</span><br><span class="line"><span class="keyword">CREATE</span> INDEX ix_revlog_cid <span class="keyword">on</span> revlog (cid);</span><br><span class="line"><span class="keyword">CREATE</span> INDEX ix_revlog_usn <span class="keyword">on</span> revlog (usn);</span><br></pre></td></tr></table></figure>

<h1 id="Models-JSONObjects"><a href="#Models-JSONObjects" class="headerlink" title="Models JSONObjects"></a>Models JSONObjects</h1><p><a target="_blank" rel="noopener" href="https://github.com/ankidroid/Anki-Android/wiki/Database-Structure#models-jsonobjects"></a></p>
<p>Here is an annotated description of the JSONObjects in the models field of the <code>col</code> table. Each object is the value of a key that’s a model id (epoch time in milliseconds):</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line"><span class="string">&quot;model id (epoch time in milliseconds)&quot;</span> :</span><br><span class="line">  &#123;</span><br><span class="line">    css : <span class="string">&quot;CSS, shared for all templates&quot;</span>,</span><br><span class="line">    did :</span><br><span class="line">        <span class="string">&quot;Long specifying the id of the deck that cards are added to by default&quot;</span>,</span><br><span class="line">    flds : [</span><br><span class="line">             <span class="string">&quot;JSONArray containing object for each field in the model as follows:&quot;</span>,</span><br><span class="line">             &#123;</span><br><span class="line">               font : <span class="string">&quot;display font&quot;</span>,</span><br><span class="line">               media : <span class="string">&quot;array of media. appears to be unused&quot;</span>,</span><br><span class="line">               name : <span class="string">&quot;field name&quot;</span>,</span><br><span class="line">               ord : <span class="string">&quot;ordinal of the field - goes from 0 to num fields -1&quot;</span>,</span><br><span class="line">               rtl : <span class="string">&quot;boolean, right-to-left script&quot;</span>,</span><br><span class="line">               size : <span class="string">&quot;font size&quot;</span>,</span><br><span class="line">               sticky : <span class="string">&quot;sticky fields retain the value that was last added </span></span><br><span class="line"><span class="string">                           when adding new notes&quot;</span></span><br><span class="line">             &#125;</span><br><span class="line">           ],</span><br><span class="line">    id : <span class="string">&quot;model ID, matches notes.mid&quot;</span>,</span><br><span class="line">    latexPost : <span class="string">&quot;String added to end of LaTeX expressions (usually \\end&#123;document&#125;)&quot;</span>,</span><br><span class="line">    latexPre : <span class="string">&quot;preamble for LaTeX expressions&quot;</span>,</span><br><span class="line">    mod : <span class="string">&quot;modification time in seconds&quot;</span>,</span><br><span class="line">    name : <span class="string">&quot;model name&quot;</span>,</span><br><span class="line">    req : [</span><br><span class="line">            <span class="string">&quot;req is unused in modern clients. May exist for backwards compatibility. </span></span><br><span class="line"><span class="string">             https://forums.ankiweb.net/t/is-req-still-used-or-present/9977</span></span><br><span class="line"><span class="string">             AnkiDroid 2.14 uses it, AnkiDroid 2.15 does not use it but still generates it.</span></span><br><span class="line"><span class="string">             Array of arrays describing, for each template T, which fields are required to generate T.</span></span><br><span class="line"><span class="string">             The array is of the form [T,string,list], where:</span></span><br><span class="line"><span class="string">             -  T is the ordinal of the template. </span></span><br><span class="line"><span class="string">             - The string is &#x27;none&#x27;, &#x27;all&#x27; or &#x27;any&#x27;. </span></span><br><span class="line"><span class="string">             - The list contains ordinal of fields, in increasing order.</span></span><br><span class="line"><span class="string">             The meaning is as follows:</span></span><br><span class="line"><span class="string">             - if the string is &#x27;none&#x27;, then no cards are generated for this template. The list should be empty.</span></span><br><span class="line"><span class="string">             - if the string is &#x27;all&#x27; then the card is generated only if each field of the list are filled</span></span><br><span class="line"><span class="string">             - if the string is &#x27;any&#x27;, then the card is generated if any of the field of the list is filled.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">             The algorithm to decide how to compute req from the template is explained on: </span></span><br><span class="line"><span class="string">             https://github.com/Arthur-Milchior/anki/blob/commented/documentation//templates_generation_rules.md&quot;</span></span><br><span class="line">          ],</span><br><span class="line">    sortf : <span class="string">&quot;Integer specifying which field is used for sorting in the browser&quot;</span>,</span><br><span class="line">    tags : <span class="string">&quot;Anki saves the tags of the last added note to the current model, use an empty array []&quot;</span>,</span><br><span class="line">    tmpls : [</span><br><span class="line">              <span class="string">&quot;JSONArray containing object of CardTemplate for each card in model&quot;</span>,</span><br><span class="line">              &#123;</span><br><span class="line">                afmt : <span class="string">&quot;answer template string&quot;</span>,</span><br><span class="line">                bafmt : <span class="string">&quot;browser answer format: </span></span><br><span class="line"><span class="string">                          used for displaying answer in browser&quot;</span>,</span><br><span class="line">                bqfmt : <span class="string">&quot;browser question format: </span></span><br><span class="line"><span class="string">                          used for displaying question in browser&quot;</span>,</span><br><span class="line">                did : <span class="string">&quot;deck override (null by default)&quot;</span>,</span><br><span class="line">                name : <span class="string">&quot;template name&quot;</span>,</span><br><span class="line">                ord : <span class="string">&quot;template number, see flds&quot;</span>,</span><br><span class="line">                qfmt : <span class="string">&quot;question format string&quot;</span></span><br><span class="line">              &#125;</span><br><span class="line">            ],</span><br><span class="line">    type : <span class="string">&quot;Integer specifying what type of model. 0 for standard, 1 for cloze&quot;</span>,</span><br><span class="line">    usn : <span class="string">&quot;usn: Update sequence number: used in same way as other usn vales in db&quot;</span>,</span><br><span class="line">    vers : <span class="string">&quot;Legacy version number (unused), use an empty array []&quot;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="Decks-JSONObjects"><a href="#Decks-JSONObjects" class="headerlink" title="Decks JSONObjects"></a>Decks JSONObjects</h1><p><a target="_blank" rel="noopener" href="https://github.com/ankidroid/Anki-Android/wiki/Database-Structure#decks-jsonobjects"></a></p>
<p>Here is an annotated description of the JSONObjects in the decks field of the <code>col</code> table:</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line"><span class="string">&quot;deck id (creation time in epoch milliseconds for most decks, &#x27;1&#x27; for the default deck)&quot;</span></span><br><span class="line">  &#123;</span><br><span class="line">    name: <span class="string">&quot;name of deck&quot;</span>, </span><br><span class="line">    extendRev: <span class="string">&quot;extended review card limit (for custom study)</span></span><br><span class="line"><span class="string">                Potentially absent, in this case it&#x27;s considered to be 10 by aqt.customstudy&quot;</span>, </span><br><span class="line">    usn: <span class="string">&quot;usn: Update sequence number: used in same way as other usn vales in db&quot;</span>, </span><br><span class="line">    collapsed: <span class="string">&quot;true when deck is collapsed&quot;</span>, </span><br><span class="line">    browserCollapsed: <span class="string">&quot;true when deck collapsed in browser&quot;</span>, </span><br><span class="line">    newToday/revToday/lrnToday : two number array.</span><br><span class="line">                                 First one is the number of days that have passed between the collection was created and the deck was last updated</span><br><span class="line">                                 The second one is equal to the number of cards seen today in <span class="built_in">this</span> deck minus the number of <span class="keyword">new</span> <span class="title class_">cards</span> in custom study today.</span><br><span class="line">                                 BEWARE, it<span class="string">&#x27;s changed in anki.sched(v2).Scheduler._updateStats and anki.sched(v2).Scheduler._updateCutoff.update  but can&#x27;</span>t be found by grepping <span class="string">&#x27;newToday&#x27;</span>, because it<span class="string">&#x27;s instead written as type+&quot;Today&quot; with type which may be new/rev/lrnToday    </span></span><br><span class="line"><span class="string">    timeToday: &quot;two number array used somehow for custom study. Currently unused in the code&quot;, </span></span><br><span class="line"><span class="string">    dyn: &quot;1 if dynamic (AKA filtered) deck&quot;, </span></span><br><span class="line"><span class="string">    extendNew: &quot;extended new card limit (for custom study). </span></span><br><span class="line"><span class="string">                Potentially absent, in this case it&#x27;</span>s considered to be <span class="number">10</span> by aqt.customstudy<span class="string">&quot;, </span></span><br><span class="line"><span class="string">    conf: &quot;</span>id of option group from dconf in `col` table. Or absent <span class="keyword">if</span> the deck is dynamic. </span><br><span class="line">          Its absent in filtered deck<span class="string">&quot;, </span></span><br><span class="line"><span class="string">    id: &quot;</span>deck <span class="title function_">ID</span> <span class="params">(automatically generated <span class="type">long</span>)</span><span class="string">&quot;, </span></span><br><span class="line"><span class="string">    mod: &quot;</span>last modification time<span class="string">&quot;, </span></span><br><span class="line"><span class="string">    desc: &quot;</span>deck description<span class="string">&quot;</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br></pre></td></tr></table></figure>

<h1 id="DConf-JSONObjects"><a href="#DConf-JSONObjects" class="headerlink" title="DConf JSONObjects"></a>DConf JSONObjects</h1><p><a target="_blank" rel="noopener" href="https://github.com/ankidroid/Anki-Android/wiki/Database-Structure#dconf-jsonobjects"></a></p>
<p>Here is an annotated description of the JSONObjects in the dconf field of the <code>col.decks</code> table:</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line"><span class="string">&quot;deck config id (creation time in epoch milliseconds for most option groups, &#x27;1&#x27; for the default option group)&quot;</span> :</span><br><span class="line">  &#123;</span><br><span class="line">        autoplay : <span class="string">&quot;whether the audio associated to a question should be</span></span><br><span class="line"><span class="string">played when the question is shown&quot;</span></span><br><span class="line">        dyn : <span class="string">&quot;Whether this deck is dynamic. Not present by default in decks.py&quot;</span></span><br><span class="line">        id : <span class="string">&quot;deck ID (automatically generated long). Not present by default in decks.py&quot;</span></span><br><span class="line">        lapse : &#123;</span><br><span class="line">            <span class="string">&quot;The configuration for lapse cards.&quot;</span></span><br><span class="line">            delays : <span class="string">&quot;The list of successive delay between the learning steps of the new cards, as explained in the manual.&quot;</span></span><br><span class="line">            leechAction : <span class="string">&quot;What to do to leech cards. 0 for suspend, 1 for mark. Numbers according to the order in which the choices appear in aqt/dconf.ui&quot;</span></span><br><span class="line">            leechFails : <span class="string">&quot;the number of lapses authorized before doing leechAction.&quot;</span></span><br><span class="line">            minInt: <span class="string">&quot;a lower limit to the new interval after a leech&quot;</span></span><br><span class="line">            mult : <span class="string">&quot;percent by which to multiply the current interval when a card goes has lapsed&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">        maxTaken : <span class="string">&quot;The number of seconds after which to stop the timer&quot;</span></span><br><span class="line">        mod : <span class="string">&quot;Last modification time&quot;</span></span><br><span class="line">        name : <span class="string">&quot;The name of the configuration&quot;</span></span><br><span class="line">        <span class="keyword">new</span> : &#123;</span><br><span class="line">            <span class="string">&quot;The configuration for new cards.&quot;</span></span><br><span class="line">            bury : <span class="string">&quot;Whether to bury cards related to new cards answered&quot;</span></span><br><span class="line">            delays : <span class="string">&quot;The list of successive delay between the learning steps of the new cards, as explained in the manual.&quot;</span></span><br><span class="line">            initialFactor : <span class="string">&quot;The initial ease factor&quot;</span></span><br><span class="line">            ints : <span class="string">&quot;The list of delays according to the button pressed while leaving the learning mode. Good, easy and unused. In the GUI, the first two elements corresponds to Graduating Interval and Easy interval&quot;</span></span><br><span class="line">            order : <span class="string">&quot;In which order new cards must be shown. NEW_CARDS_RANDOM = 0 and NEW_CARDS_DUE = 1.&quot;</span></span><br><span class="line">            perDay : <span class="string">&quot;Maximal number of new cards shown per day.&quot;</span></span><br><span class="line">            separate : <span class="string">&quot;Seems to be unused in the code.&quot;</span></span><br><span class="line">                </span><br><span class="line">        &#125;</span><br><span class="line">        replayq : <span class="string">&quot;whether the audio associated to a question should be played when the answer is shown&quot;</span></span><br><span class="line">        rev : &#123;</span><br><span class="line">            <span class="string">&quot;The configuration for review cards.&quot;</span></span><br><span class="line">            bury : <span class="string">&quot;Whether to bury cards related to new cards answered&quot;</span></span><br><span class="line">            ease4 : <span class="string">&quot;the number to add to the easyness when the easy button is pressed&quot;</span></span><br><span class="line">            fuzz : <span class="string">&quot;The new interval is multiplied by a random number between -fuzz and fuzz&quot;</span></span><br><span class="line">            ivlFct : <span class="string">&quot;multiplication factor applied to the intervals Anki generates&quot;</span></span><br><span class="line">            maxIvl : <span class="string">&quot;the maximal interval for review&quot;</span></span><br><span class="line">            minSpace : <span class="string">&quot;not currently used according to decks.py code&#x27;s comment&quot;</span></span><br><span class="line">            perDay : <span class="string">&quot;Numbers of cards to review per day&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">        timer : <span class="string">&quot;whether timer should be shown (1) or not (0)&quot;</span></span><br><span class="line">        usn : <span class="string">&quot;See usn in cards table for details.&quot;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="configuration-JSONObject"><a href="#configuration-JSONObject" class="headerlink" title="configuration JSONObject"></a>configuration JSONObject</h1><p><a target="_blank" rel="noopener" href="https://github.com/ankidroid/Anki-Android/wiki/Database-Structure#configuration-jsonobject"></a></p>
<p>Here is an annotated description of the JSONObject in the conf field of the <code>col</code> table when the collection is started. More values may be added to it by any add-on. Unlike the <code>models</code>, <code>decks</code>, and <code>dconf</code> JSONObjects, there should be only one <code>conf</code> JSONObject per collection.</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;curDeck&quot;</span>: <span class="string">&quot;The id (as int) of the last deck selected (during review, adding card, changing the deck of a card)&quot;</span>,</span><br><span class="line">    <span class="string">&quot;activeDecks&quot;</span>: <span class="string">&quot;The list containing the current deck id and its descendant (as ints)&quot;</span>,</span><br><span class="line">    <span class="string">&quot;newSpread&quot;</span>: <span class="string">&quot;In which order to view to review the cards. This can be selected in Preferences&gt;Basic. Possible values are:</span></span><br><span class="line"><span class="string">      0 -- NEW_CARDS_DISTRIBUTE (Mix new cards and reviews)</span></span><br><span class="line"><span class="string">      1 -- NEW_CARDS_LAST (see new cards after review)</span></span><br><span class="line"><span class="string">      2 -- NEW_CARDS_FIRST (See new card before review)&quot;</span>,</span><br><span class="line">    <span class="string">&quot;collapseTime&quot;</span>: <span class="string">&quot;&#x27;Preferences&gt;Basic&gt;Learn ahead limit&#x27;*60. If there is no more card to review now but next card in learning is in less than collapseTime second, show it now.</span></span><br><span class="line"><span class="string">    If there are no other card to review, then we can review cards in learning in advance if they are due in less than this number of seconds.&quot;</span>,</span><br><span class="line">    <span class="string">&quot;timeLim&quot;</span>: <span class="string">&quot;&#x27;Preferences&gt;Basic&gt;Timebox time limit&#x27;*60. Each time this number of second elapse, anki tell you how many card you reviewed.&quot;</span>,</span><br><span class="line">    <span class="string">&quot;estTimes&quot;</span>: <span class="string">&quot;&#x27;Preferences&gt;Basic&gt;Show next review time above answer buttons&#x27;. A Boolean.&quot;</span></span><br><span class="line">    <span class="string">&quot;dueCounts&quot;</span>: <span class="string">&quot;&#x27;Preferences&gt;Basic&gt;Show remaining card count during review&#x27;. A Boolean.&quot;</span></span><br><span class="line">    <span class="string">&quot;curModel&quot;</span>: <span class="string">&quot;Id (as string) of the last note type (a.k.a. model) used (i.e. either when creating a note, or changing the note type of a note).&quot;</span>,</span><br><span class="line">    <span class="string">&quot;nextPos&quot;</span>: <span class="string">&quot;This is the highest value of a due value of a new card. It allows to decide the due number to give to the next note created. (This is useful to ensure that cards are seen in order in which they are added.&quot;</span>,</span><br><span class="line">    <span class="string">&quot;sortType&quot;</span>: <span class="string">&quot;A string representing how the browser must be sorted. Its value should be one of the possible value of &#x27;aqt.browsers.DataModel.activeCols&#x27; (or equivalently of &#x27;activeCols&#x27;  but not any of (&#x27;question&#x27;, &#x27;answer&#x27;, &#x27;template&#x27;, &#x27;deck&#x27;, &#x27;note&#x27;, &#x27;noteTags&#x27;)&quot;</span>,</span><br><span class="line">    <span class="string">&quot;sortBackwards&quot;</span>: <span class="string">&quot;A Boolean stating whether the browser sorting must be in increasing or decreasing order&quot;</span>,</span><br><span class="line">    <span class="string">&quot;addToCur&quot;</span>: <span class="string">&quot;A Boolean. True for &#x27;When adding, default to current deck&#x27; in Preferences&gt;Basic. False for &#x27;Change deck depending on note type&#x27;.&quot;</span>,</span><br><span class="line">    <span class="string">&quot;dayLearnFirst&quot;</span>: <span class="string">&quot;A Boolean. It corresponds to the option &#x27;Show learning cards with larger steps before reviews&#x27;. But this option does not seems to appear in the preference box&quot;</span>,</span><br><span class="line">    <span class="string">&quot;newBury&quot;</span>: <span class="string">&quot;A Boolean. Always set to true and not read anywhere in the code but at the place where it is set to True if it is not already true. Hence probably quite useful.&quot;</span>,</span><br><span class="line"></span><br><span class="line">    <span class="string">&quot;lastUnburied&quot;</span>:<span class="string">&quot;The date of the last time the scheduler was initialized or reset. If it&#x27;s not today, then buried notes must be unburied. This is not in the json until scheduler is used once.&quot;</span>,</span><br><span class="line">    <span class="string">&quot;activeCols&quot;</span>:<span class="string">&quot;the list of name of columns to show in the browser. Possible values are listed in aqt.browser.Browser.setupColumns. They are:</span></span><br><span class="line"><span class="string">    &#x27;question&#x27; -- the browser column&#x27;Question&#x27;,</span></span><br><span class="line"><span class="string">    &#x27;answer&#x27; -- the browser column&#x27;Answer&#x27;,</span></span><br><span class="line"><span class="string">    &#x27;template&#x27; -- the browser column&#x27;Card&#x27;,</span></span><br><span class="line"><span class="string">    &#x27;deck&#x27; -- the browser column&#x27;Deck&#x27;,</span></span><br><span class="line"><span class="string">    &#x27;noteFld&#x27; -- the browser column&#x27;Sort Field&#x27;,</span></span><br><span class="line"><span class="string">    &#x27;noteCrt&#x27; -- the browser column&#x27;Created&#x27;,</span></span><br><span class="line"><span class="string">    &#x27;noteMod&#x27; -- the browser column&#x27;Edited&#x27;,</span></span><br><span class="line"><span class="string">    &#x27;cardMod&#x27; -- the browser column&#x27;Changed&#x27;,</span></span><br><span class="line"><span class="string">    &#x27;cardDue&#x27; -- the browser column&#x27;Due&#x27;,</span></span><br><span class="line"><span class="string">    &#x27;cardIvl&#x27; -- the browser column&#x27;Interval&#x27;,</span></span><br><span class="line"><span class="string">    &#x27;cardEase&#x27; -- the browser column&#x27;Ease&#x27;,</span></span><br><span class="line"><span class="string">    &#x27;cardReps&#x27; -- the browser column&#x27;Reviews&#x27;,</span></span><br><span class="line"><span class="string">    &#x27;cardLapses&#x27; -- the browser column&#x27;Lapses&#x27;,</span></span><br><span class="line"><span class="string">    &#x27;noteTags&#x27; -- the browser column&#x27;Tags&#x27;,</span></span><br><span class="line"><span class="string">    &#x27;note&#x27; -- the browser column&#x27;Note&#x27;,</span></span><br><span class="line"><span class="string">    The default columns are: noteFld, template, cardDue and deck</span></span><br><span class="line"><span class="string">    This is not in the json at creation. It&#x27;s added when the browser is open.</span></span><br><span class="line"><span class="string">     &quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">叶落花开</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://www.yeluohuakai.com/posts/2024/09/135ce13c.html">https://www.yeluohuakai.com/posts/2024/09/135ce13c.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://www.yeluohuakai.com" target="_blank">叶落花开的博客</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a><a class="post-meta__tags" href="/tags/Anki/">Anki</a></div><div class="post_share"><div class="social-share" data-image="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://fastly.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/2024/09/9ce5cc31.html"><img class="prev-cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Xcode-解决&quot;Permission Failure&quot; (10/2007); server message = &quot;CREATE operation not permitted&quot;问题</div></div></a></div><div class="next-post pull-right"><a href="/posts/2024/09/31f9f56.html"><img class="next-cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">IOS模拟器无法使用Apple ID登录解决办法</div></div></a></div></nav><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/loading.gif" data-original="/img/ava.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">叶落花开</div><div class="author-info__description">持续学习，记录后端技术、web技术，以及对认知、技术变现的思考。</div></div><div class="card-info-data is-center"><div class="card-info-data-item"><a href="/archives/"><div class="headline">文章</div><div class="length-num">266</div></a></div><div class="card-info-data-item"><a href="/tags/"><div class="headline">标签</div><div class="length-num">106</div></a></div><div class="card-info-data-item"><a href="/categories/"><div class="headline">分类</div><div class="length-num">38</div></a></div></div></div><div class="card-widget user-map" id="user-map"><div class="item-headline"><i class="fas fa-link"></i><span>友情链接</span></div><div class="item-content"><ul class="entry"><li><a href="/bszs" title="各大高校博士招生信息">各大高校博士招生信息</a></li><li><a target="_blank" rel="noopener" href="https://www.xiaoxinsoft.com" title="小新软件服务">小新软件安装服务</a></li></ul></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Anki-database-structure"><span class="toc-number">1.</span> <span class="toc-text">Anki database structure</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Terminology"><span class="toc-number">2.</span> <span class="toc-text">Terminology</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Database-schema"><span class="toc-number">3.</span> <span class="toc-text">Database schema</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Cards"><span class="toc-number">3.1.</span> <span class="toc-text">Cards</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Collection"><span class="toc-number">3.2.</span> <span class="toc-text">Collection</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Graves"><span class="toc-number">3.3.</span> <span class="toc-text">Graves</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Notes"><span class="toc-number">3.4.</span> <span class="toc-text">Notes</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Review-Log"><span class="toc-number">3.5.</span> <span class="toc-text">Review Log</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Indexes"><span class="toc-number">3.6.</span> <span class="toc-text">Indexes</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Models-JSONObjects"><span class="toc-number">4.</span> <span class="toc-text">Models JSONObjects</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Decks-JSONObjects"><span class="toc-number">5.</span> <span class="toc-text">Decks JSONObjects</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#DConf-JSONObjects"><span class="toc-number">6.</span> <span class="toc-text">DConf JSONObjects</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#configuration-JSONObject"><span class="toc-number">7.</span> <span class="toc-text">configuration JSONObject</span></a></li></ol></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2025 By 叶落花开</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">本地搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://fastly.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>(()=>{
  const init = () => {
    twikoo.init(Object.assign({
      el: '#twikoo-wrap',
      envId: 'freecloud-0gzubvbebcf38cf6',
      region: '',
      onCommentLoaded: function () {
        btf.loadLightbox(document.querySelectorAll('#twikoo .tk-content img:not(.vemoji)'))
      }
    }, null))
  }

  const getCount = () => {
    twikoo.getCommentsCount({
      envId: 'freecloud-0gzubvbebcf38cf6',
      region: '',
      urls: [window.location.pathname],
      includeReply: false
    }).then(function (res) {
      document.getElementById('twikoo-count').innerText = res[0].count
    }).catch(function (err) {
      console.error(err);
    });
  }

  const runFn = () => {
    init()
    
  }

  const loadTwikoo = () => {
    if (typeof twikoo === 'object') {
      setTimeout(runFn,0)
      return
    } 
    getScript('https://fastly.jsdelivr.net/npm/twikoo/dist/twikoo.all.min.js').then(runFn)
  }

  if ('Twikoo' === 'Twikoo' || !false) {
    if (false) btf.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else loadTwikoo()
  } else {
    window.loadOtherComment = () => {
      loadTwikoo()
    }
  }
})()</script></div><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="https://fastly.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-nest.min.js"></script></div>
        <style>
            [bg-lazy] {
                background-image: none !important;
                background-color: #eee !important;
            }
        </style>
        <script>
            window.imageLazyLoadSetting = {
                isSPA: false,
                preloadRatio: 1,
                processImages: null,
            };
        </script><script>window.addEventListener("load",function(){var t=/\.(gif|jpg|jpeg|tiff|png)$/i,r=/^data:image\/[a-z]+;base64,/;Array.prototype.slice.call(document.querySelectorAll("img[data-original]")).forEach(function(a){var e=a.parentNode;"A"===e.tagName&&(e.href.match(t)||e.href.match(r))&&(e.href=a.dataset.original)})});</script><script>!function(r){r.imageLazyLoadSetting.processImages=t;var e=r.imageLazyLoadSetting.isSPA,n=r.imageLazyLoadSetting.preloadRatio||1,c=a();function a(){var t=Array.prototype.slice.call(document.querySelectorAll("img[data-original]")),e=Array.prototype.slice.call(document.querySelectorAll("[bg-lazy]"));return t.concat(e)}function t(){e&&(c=a());for(var t,o=0;o<c.length;o++)0<=(t=(t=c[o]).getBoundingClientRect()).bottom&&0<=t.left&&t.top<=(r.innerHeight*n||document.documentElement.clientHeight*n)&&function(){var t,e,n,a,i=c[o];e=function(){c=c.filter(function(t){return i!==t}),r.imageLazyLoadSetting.onImageLoaded&&r.imageLazyLoadSetting.onImageLoaded(i)},(t=i).hasAttribute("bg-lazy")?(t.removeAttribute("bg-lazy"),e&&e()):(n=new Image,a=t.getAttribute("data-original"),n.onload=function(){t.src=a,t.removeAttribute("data-original"),e&&e()},t.src!==a&&(n.src=a))}()}function i(){clearTimeout(t.tId),t.tId=setTimeout(t,500)}t(),document.addEventListener("scroll",i),r.addEventListener("resize",i),r.addEventListener("orientationchange",i)}(this);</script></body></html>